# netlify.toml
[build]
  publish = "public"
  functions = "netlify/functions"
  node_version = "20"
  # Gera o public/config.js a partir de variáveis do ambiente antes do build
  command = "bash scripts/render-config.sh"
# Headers de segurança
[[headers]]
  for = "/*"
  [headers.values]
    X-Frame-Options = "DENY"
    X-Content-Type-Options = "nosniff"
    Referrer-Policy = "no-referrer"
    Permissions-Policy = "interest-cohort=()"

# Mapeia funções (os endpoints já seguem o padrão /.netlify/functions/<nome>)
# Certifique-se de nomear os arquivos:
# netlify/functions/build-info.js, netlify/functions/create-user.js e netlify/functions/delete-user.js

[functions]
  node_bundler = "esbuild"
  included_files = []

# Variáveis de ambiente (definir no painel do Netlify)
#  - SUPABASE_URL
#  - SUPABASE_SERVICE_ROLE
# As demais (COMMIT_REF, BRANCH, CONTEXT, SITE_NAME) são fornecidas pelo Netlify.
